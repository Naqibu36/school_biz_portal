<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>سکول + بزنس پورٹل</title>
<style>
/* --- CSS سب کچھ یہاں --- */
body{font-family:sans-serif;background:#f5f5f5;margin:0;padding:0;}
.header{background:#2e7d32;color:white;padding:10px;text-align:center;}
.tabs button{padding:10px;margin:5px;cursor:pointer;}
.tabcontent{display:none;padding:20px;background:white;margin:10px;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
table,th,td{border:1px solid #ccc;}
th,td{padding:8px;text-align:center;}
button{padding:5px 10px;margin:2px;}
input[type=text], input[type=number], input[type=file]{padding:5px;margin:5px;}
</style>
</head>
<body>

<div class="header">
<h1>سکول + بزنس پورٹل</h1>
</div>

<div class="tabs">
<button onclick="openTab('school')">سکول سیکشن</button>
<button onclick="openTab('business')">بزنس سیکشن</button>
</div>

<!-- سکول سیکشن -->
<div id="school" class="tabcontent" style="display:block;">
<h2>سکول سیکشن</h2>
<p>یہاں سکول والا تمام فیچرز بغیر تبدیلی کام کر رہے ہیں۔</p>
</div>

<!-- بزنس سیکشن -->
<div id="business" class="tabcontent">
<h2>بزنس سیکشن</h2>

<form id="customerForm">
<input type="text" id="name" placeholder="کسٹمر کا نام" required>
<input type="number" id="amount" placeholder="رقم" required>
رسید: <input type="file" id="receipt">
تصویر: <input type="file" id="image">
<button type="submit">ایڈ کریں</button>
</form>

<table id="customerTable">
<thead>
<tr><th>#</th><th>نام</th><th>رقم</th><th>رسید</th><th>تصویر</th><th>ایڈٹ/ڈیلیٹ</th></tr>
</thead>
<tbody></tbody>
</table>

<button id="exportBtn">Export CSV</button>
</div>

<script>
// --- JS سب کچھ یہاں ---
let customers = [];

function openTab(tabName){
    document.querySelectorAll('.tabcontent').forEach(tab=>tab.style.display='none');
    document.getElementById(tabName).style.display='block';
}

function renderTable(){
    let tbody='';
    customers.forEach((c,i)=>{
        tbody+='<tr>';
        tbody+='<td>'+(i+1)+'</td>';
        tbody+='<td>'+c.name+'</td>';
        tbody+='<td>'+c.amount+'</td>';
        tbody+='<td>'+(c.receipt ? '<a href="'+c.receipt+'" target="_blank">دیکھیں</a>' : '')+'</td>';
        tbody+='<td>'+(c.image ? '<a href="'+c.image+'" target="_blank">دیکھیں</a>' : '')+'</td>';
        tbody+='<td><button onclick="editCustomer('+i+')">ایڈٹ</button><button onclick="deleteCustomer('+i+')">ڈیلیٹ</button></td>';
        tbody+='</tr>';
    });
    document.querySelector('#customerTable tbody').innerHTML=tbody;
}

document.getElementById('customerForm').addEventListener('submit', function(e){
    e.preventDefault();
    let name=document.getElementById('name').value;
    let amount=document.getElementById('amount').value;
    let receipt=document.getElementById('receipt').files[0];
    let image=document.getElementById('image').files[0];

    // فائل اپلوڈ سادہ طور پر base64 (لوکل سٹوریج میں)
    if(receipt){
        let reader=new FileReader();
        reader.onload=function(){ 
            let receiptData=reader.result;
            addCustomer(name, amount, receiptData, image?URL.createObjectURL(image):'');
        }
        reader.readAsDataURL(receipt);
    } else {
        addCustomer(name, amount, '', image?URL.createObjectURL(image):'');
    }
});

function addCustomer(name, amount, receipt, image){
    customers.push({name, amount, receipt, image});
    renderTable();
    document.getElementById('customerForm').reset();
}

function deleteCustomer(index){
    if(confirm('کیا آپ واقعی حذف کرنا چاہتے ہیں؟')){
        customers.splice(index,1);
        renderTable();
    }
}

function editCustomer(index){
    let c=customers[index];
    let newName=prompt('نیا نام درج کریں:', c.name);
    if(newName) c.name=newName;
    let newAmount=prompt('نئی رقم درج کریں:', c.amount);
    if(newAmount) c.amount=newAmount;
    renderTable();
}

// CSV ایکسپورٹ
document.getElementById('exportBtn').addEventListener('click', function(){
    let csv='نام,رقم,رسید,تصویر\n';
    customers.forEach(c=>{
        csv+=`"${c.name}","${c.amount}","${c.receipt}","${c.image}"\n`;
    });
    let blob=new Blob([csv], {type:'text/csv'});
    let url=URL.createObjectURL(blob);
    let a=document.createElement('a');
    a.href=url; a.download='customers.csv';
    a.click();
    URL.revokeObjectURL(url);
});
</script>

</body>
</html>
