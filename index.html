<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>سکول اور بزنس پورٹل - POS</title>
<style>
body { font-family: sans-serif; background: #f5f5f5; margin:0; padding:0; }
#loginArea, #setAdminArea { max-width:400px; margin:50px auto; padding:20px; background:#fff; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
input, button { width:100%; padding:10px; margin:5px 0; border-radius:5px; border:1px solid #ccc; }
#posArea { display:none; max-width:800px; margin:20px auto; padding:20px; background:#e8f5e9; border-radius:8px; }
button.logoutBtn { background:#d32f2f; color:#fff; border:none; }
</style>
</head>
<body>

<div id="setAdminArea">
  <h3>ایڈمن سیٹ کریں</h3>
  <input type="email" id="adminEmail" placeholder="ای میل">
  <input type="text" id="adminPhone" placeholder="فون نمبر (اختیاری)">
  <input type="password" id="adminPass" placeholder="پاس ورڈ">
  <button onclick="setAdmin()">سیٹ ایڈمن</button>
  <p id="adminMsg"></p>
</div>

<div id="loginArea">
  <h3>لاگ ان</h3>
  <input type="email" id="loginEmail" placeholder="ای میل">
  <input type="password" id="loginPass" placeholder="پاس ورڈ">
  <button onclick="login()">لاگ ان کریں</button>
  <p id="loginMsg"></p>
</div>

<div id="posArea">
  <h2>POS پورٹل</h2>
  <p>صرف ایڈمن لاگ ان کر سکتا ہے۔</p>
  <button class="logoutBtn" onclick="logout()">لاگ آؤٹ</button>
</div>

<script>
// LocalStorage shortcuts
const LS = {
  set: (k,v)=>localStorage.setItem(k,JSON.stringify(v)),
  get: (k)=>JSON.parse(localStorage.getItem(k)),
  remove: (k)=>localStorage.removeItem(k)
};
const K = {admin:'adminCred', session:'adminSession'};

// SHA-256 hash function
async function hashPass(p){
  const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(p));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

// Set Admin
async function setAdmin(){
  const email = document.getElementById('adminEmail').value.trim();
  const phone = document.getElementById('adminPhone').value.trim();
  const pass = document.getElementById('adminPass').value;
  if(!email || !pass) { alert('ای میل اور پاس ورڈ لازمی ہے'); return; }
  const hashed = await hashPass(pass);
  LS.set(K.admin,{email,phone,pass:hashed});
  document.getElementById('adminMsg').textContent = 'ایڈمن سیٹ ہوگیا ✅';
  document.getElementById('setAdminArea').style.display = 'none';
}

// Login function
async function login(){
  const adm = LS.get(K.admin);
  if(!adm){ alert('پہلے Set Admin کریں'); return; }
  const email = document.getElementById('loginEmail').value.trim();
  const pass = document.getElementById('loginPass').value;
  const hashed = await hashPass(pass);
  if(email===adm.email && hashed===adm.pass){
    LS.set(K.session,{loggedIn:true});
    showPOS();
  } else {
    document.getElementById('loginMsg').textContent='غلط تفصیل ❌';
  }
}

// Logout function
function logout(){
  LS.remove(K.session);
  document.getElementById('posArea').style.display='none';
  document.getElementById('loginArea').style.display='block';
  document.getElementById('loginMsg').textContent='آپ لاگ آؤٹ ہوگئے۔';
}

// Show POS if logged in
function showPOS(){
  document.getElementById('posArea').style.display='block';
  document.getElementById('loginArea').style.display='none';
}

// Page load check
window.onload = ()=>{
  if(LS.get(K.admin)) document.getElementById('setAdminArea').style.display='none';
  if(LS.get(K.session)?.loggedIn) showPOS();
}
</script>

</body>
</html>
