<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سکول اور بزنس پورٹل - سوشل لاگ ان</title>
    <style>
        /* آپ کا CSS یہاں آئے گا */
    </style>
</head>
<body>
    <div class="container">
        <h1>سکول اور بزنس پورٹل</h1>

        <!-- رجسٹریشن اور لاگ ان سیکشن -->
        <div id="auth-section">
            <h2>رجسٹریشن</h2>
            <input type="text" id="reg-name" placeholder="نام" required>
            <input type="email" id="reg-email" placeholder="ای میل" required>
            <input type="password" id="reg-password" placeholder="پاسورڈ" required>
            <button onclick="register()">رجسٹر کریں</button>

            <h2>لاگ ان</h2>
            <input type="email" id="login-email" placeholder="ای میل">
            <input type="password" id="login-password" placeholder="پاسورڈ">
            <button onclick="login()">لاگ ان</button>
            <button onclick="showForgot()">پاسورڈ بھول گئے؟</button>

            <!-- سوشل لاگ ان بٹنز -->
            <div id="google-signin2"></div>
            <div id="facebook-login-button"></div>
        </div>

        <!-- پاسورڈ ری سیٹ سیکشن -->
        <div id="forgot-section" class="hidden">
            <h2>نیا پاسورڈ بنائیں</h2>
            <input type="email" id="forgot-email" placeholder="ای میل">
            <input type="password" id="forgot-new-password" placeholder="نیا پاسورڈ">
            <button onclick="resetPassword()">ری سیٹ کریں</button>
            <button onclick="hideForgot()">واپس لاگ ان</button>
        </div>

        <!-- بزنس سیکشن -->
        <div id="business-section" class="hidden">
            <h2>بزنس ڈیٹا</h2>
            <input type="text" id="item-name" placeholder="آئٹم کا نام">
            <input type="number" id="item-amount" placeholder="رقم">
            <button onclick="addItem()">ایڈ کریں</button>
            
            <table>
                <thead>
                    <tr>
                        <th>آئٹم</th>
                        <th>رقم</th>
                        <th>عمل</th>
                    </tr>
                </thead>
                <tbody id="items-table">
                </tbody>
            </table>
            <button onclick="logout()">لاگ آؤٹ</button>
        </div>
    </div>

    <script>
        // لوکل اسٹوریج میں یوزرز
        let users = JSON.parse(localStorage.getItem('users') || '[]');
        let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');

        function saveUsers() {
            localStorage.setItem('users', JSON.stringify(users));
        }

        function register() {
            let name = document.getElementById('reg-name').value;
            let email = document.getElementById('reg-email').value;
            let password = document.getElementById('reg-password').value;

            if(users.find(u => u.email === email)) {
                alert("یہ ای میل پہلے سے رجسٹر ہے!");
                return;
            }

            users.push({name, email, password, items: []});
            saveUsers();
            alert("رجسٹریشن مکمل!");
        }

        function login() {
            let email = document.getElementById('login-email').value;
            let password = document.getElementById('login-password').value;
            let user = users.find(u => u.email === email && u.password === password);
            if(user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                document.getElementById('auth-section').classList.add('hidden');
                document.getElementById('business-section').classList.remove('hidden');
                renderItems();
            } else {
                alert("ای میل یا پاسورڈ غلط ہے");
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('business-section').classList.add('hidden');
            document.getElementById('auth-section').classList.remove('hidden');
        }

        function renderItems() {
            let tbody = document.getElementById('items-table');
            tbody.innerHTML = '';
            currentUser.items.forEach((item, index) => {
                let tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.amount}</td>
                    <td>
                        <button class="edit-btn" onclick="editItem(${index})">ایڈیٹ</button>
                        <button class="delete-btn" onclick="deleteItem(${index})">ڈیلیٹ</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function addItem() {
            let name = document.getElementById('item-name').value;
            let amount = parseFloat(document.getElementById('item-amount').value);
            if(!name || !amount) { alert("تمام فیلڈز پر کریں"); return; }
            currentUser.items.push({name, amount});
            saveCurrentUser();
            renderItems();
            document.getElementById('item-name').value = '';
            document.getElementById('item-amount').value = '';
        }

        function editItem(index) {
            let newName = prompt("نیا نام درج کریں", currentUser.items[index].name);
            let newAmount = prompt("نئی رقم درج کریں", currentUser.items[index].amount);
            if(newName && newAmount) {
                currentUser.items[index] = {name: newName, amount: parseFloat(newAmount)};
                saveCurrentUser();
                renderItems();
            }
        }

        function deleteItem(index) {
            if(confirm("کیا آپ واقعی یہ ڈیلیٹ کرنا چاہتے ہیں؟")) {
                currentUser.items.splice(index, 1);
                saveCurrentUser();
                renderItems();
            }
        }

        function saveCurrentUser() {
            users = users.map(u => u.email === currentUser.email ? currentUser : u);
            saveUsers();
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
        }

        // اگر یوزر پہلے سے لاگ ان ہے
        if(currentUser) {
            document.getElementById('auth-section').classList.add('hidden');
            document.getElementById('business-section').classList.remove('hidden');
            renderItems();
        }

        // Google لاگ ان
        function handleCredentialResponse(response) {
            const userObject = jwt_decode(response.credential);
            console.log(userObject);
            // یہاں آپ یوزر کی معلومات استعمال کر سکتے ہیں
        }

        google.accounts.id.initialize({
            client_id: 'YOUR_GOOGLE_CLIENT_ID',
            callback: handleCredentialResponse
        });
        google.accounts.id.renderButton(
            document.getElementById("google-signin2"),
            { theme: "outline", size: "large" }
        );

        // Facebook لاگ ان
        window.fbAsyncInit = function() {
            FB.init({
                appId      : 'YOUR_FACEBOOK_APP_ID',
                cookie     : true,
                xfbml      : true,
                version    : 'v13.0'
            });
            FB.AppEvents.logPageView();
        };

        (function(d, s, id){
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement(s); js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));

        function fbLogin() {
            FB.login(function(response) {
                if (response.authResponse) {
                    console.log('Welcome! Fetching your information.... ');
                    FB.api('/me', function(response) {
                        console.log('Good to see you, ' + response.name + '.');
                    });
                } else {
                    console.log('User cancelled login or did not fully authorize.');
                }
            });
        }
    </script>
</body>
</html>
