<!DOCTYPE html>
<html lang="ur">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>سکول اور بزنس پورٹل - مکمل POS</title>
<style>
body { font-family: sans-serif; background: #f5f5f5; margin: 0; padding: 0; }
header { background: #4CAF50; color: white; padding: 10px; text-align: center; }
nav { display: flex; flex-wrap: wrap; justify-content: center; background: #333; }
nav button { background: #333; color: white; border: none; padding: 10px 20px; cursor: pointer; margin:2px; }
nav button.active { background: #4CAF50; }
section { display: none; padding: 20px; }
section.active { display: block; }
table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
table, th, td { border: 1px solid #ccc; }
th, td { padding: 8px; text-align: center; }
input, select { padding: 5px; margin: 5px 0; width: 100%; }
.btn { background: #4CAF50; color: white; padding: 5px 10px; border: none; cursor: pointer; margin:2px; }
.btn.red { background: #f44336; }
</style>
</head>
<body>

<header>
    <h1>سکول اور بزنس پورٹل - مکمل POS</h1>
</header>

<nav>
    <button class="tab-btn active" data-tab="school">سکول پینل</button>
    <button class="tab-btn" data-tab="business">بزنس / Inventory</button>
    <button class="tab-btn" data-tab="sales">سیلز / کارٹ</button>
    <button class="tab-btn" data-tab="reports">رپورٹس</button>
</nav>

<!-- ====== School Panel ====== -->
<section id="school" class="active">
    <h2>اساتذہ کی فہرست</h2>
    <table id="teachersTable">
        <thead>
            <tr>
                <th>تصویر</th>
                <th>نام</th>
                <th>ایڈیٹ</th>
                <th>حذف</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <h3>نیا استاد شامل کریں</h3>
    <input type="text" id="teacherName" placeholder="استاد کا نام">
    <input type="text" id="teacherImage" placeholder="تصویر کا URL">
    <button class="btn" onclick="addTeacher()">شامل کریں</button>
</section>

<!-- ====== Business Inventory ====== -->
<section id="business">
    <h2>Inventory</h2>
    <table id="inventoryTable">
        <thead>
            <tr>
                <th>آئٹم</th>
                <th>قیمت</th>
                <th>quantity</th>
                <th>ایڈیٹ</th>
                <th>حذف</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <h3>نیا آئٹم شامل کریں</h3>
    <input type="text" id="itemName" placeholder="آئٹم کا نام">
    <input type="number" id="itemPrice" placeholder="قیمت">
    <input type="number" id="itemQty" placeholder="quantity">
    <button class="btn" onclick="addItem()">شامل کریں</button>
</section>

<!-- ====== Sales / Cart ====== -->
<section id="sales">
    <h2>سیلز / کارٹ</h2>
    <select id="productSelect"></select>
    <input type="number" id="productQty" placeholder="Quantity" value="1">
    <button class="btn" onclick="addToCart()">کارٹ میں شامل کریں</button>

    <h3>کارٹ</h3>
    <table id="cartTable">
        <thead>
            <tr>
                <th>آئٹم</th>
                <th>قیمت</th>
                <th>quantity</th>
                <th>کل</th>
                <th>حذف</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <h3>کل رقم: <span id="totalAmount">0</span></h3>
    <button class="btn" onclick="checkout()">Checkout</button>
</section>

<!-- ====== Reports ====== -->
<section id="reports">
    <h2>رپورٹس</h2>
    <button class="btn" onclick="viewSalesReport()">سیلز رپورٹ دیکھیں</button>
    <button class="btn" onclick="backupData()">ڈیٹا بیک اپ کریں</button>
    <pre id="reportOutput"></pre>
</section>

<script>
// ===== Tab Switching =====
const tabs = document.querySelectorAll('.tab-btn');
tabs.forEach(tab => {
    tab.addEventListener('click', () => {
        document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(tab.dataset.tab).classList.add('active');
        tab.classList.add('active');
        if(tab.dataset.tab === 'sales') populateProductSelect();
    });
});

// ===== School Panel =====
function loadTeachers() {
    const teachers = JSON.parse(localStorage.getItem('sch_teachers') || '[]');
    const tbody = document.querySelector('#teachersTable tbody');
    tbody.innerHTML = '';
    teachers.forEach((t, i) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td><img src="${t.image}" width="50"></td>
            <td>${t.name}</td>
            <td><button class="btn" onclick="editTeacher(${i})">ایڈیٹ</button></td>
            <td><button class="btn red" onclick="deleteTeacher(${i})">حذف</button></td>
        `;
        tbody.appendChild(row);
    });
}
function addTeacher() {
    const name = document.getElementById('teacherName').value.trim();
    const image = document.getElementById('teacherImage').value.trim();
    if (!name) return alert('نام ڈالیں');
    const teachers = JSON.parse(localStorage.getItem('sch_teachers') || '[]');
    teachers.push({name, image});
    localStorage.setItem('sch_teachers', JSON.stringify(teachers));
    loadTeachers();
    document.getElementById('teacherName').value = '';
    document.getElementById('teacherImage').value = '';
}
function editTeacher(index) {
    const teachers = JSON.parse(localStorage.getItem('sch_teachers') || '[]');
    const newName = prompt('نیا نام:', teachers[index].name);
    if(newName) { teachers[index].name = newName; localStorage.setItem('sch_teachers', JSON.stringify(teachers)); loadTeachers();}
}
function deleteTeacher(index) {
    const teachers = JSON.parse(localStorage.getItem('sch_teachers') || '[]');
    teachers.splice(index,1);
    localStorage.setItem('sch_teachers', JSON.stringify(teachers));
    loadTeachers();
}
loadTeachers();

// ===== Inventory =====
function loadInventory() {
    const items = JSON.parse(localStorage.getItem('pos_inventory') || '[]');
    const tbody = document.querySelector('#inventoryTable tbody');
    tbody.innerHTML = '';
    items.forEach((i, idx) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${i.name}</td>
            <td>${i.price}</td>
            <td>${i.qty}</td>
            <td><button class="btn" onclick="editItem(${idx})">ایڈیٹ</button></td>
            <td><button class="btn red" onclick="deleteItem(${idx})">حذف</button></td>
        `;
        tbody.appendChild(row);
    });
}
function addItem() {
    const name = document.getElementById('itemName').value.trim();
    const price = parseFloat(document.getElementById('itemPrice').value);
    const qty = parseInt(document.getElementById('itemQty').value);
    if (!name || isNaN(price) || isNaN(qty)) return alert('تمام فیلڈز بھریں');
    const items = JSON.parse(localStorage.getItem('pos_inventory') || '[]');
    items.push({name, price, qty});
    localStorage.setItem('pos_inventory', JSON.stringify(items));
    loadInventory();
    document.getElementById('itemName').value = '';
    document.getElementById('itemPrice').value = '';
    document.getElementById('itemQty').value = '';
}
function editItem(idx) {
    const items = JSON.parse(localStorage.getItem('pos_inventory') || '[]');
    const newName = prompt('نیا نام:', items[idx].name);
    const newPrice = prompt('نئی قیمت:', items[idx].price);
    const newQty = prompt('نئی quantity:', items[idx].qty);
    if(newName && !isNaN(newPrice) && !isNaN(newQty)){
        items[idx] = {name:newName, price:parseFloat(newPrice), qty:parseInt(newQty)};
        localStorage.setItem('pos_inventory', JSON.stringify(items));
        loadInventory();
    }
}
function deleteItem(idx) {
    const items = JSON.parse(localStorage.getItem('pos_inventory') || '[]');
    items.splice(idx,1);
    localStorage.setItem('pos_inventory', JSON.stringify(items));
    loadInventory();
}
loadInventory();

// ===== Sales / Cart =====
let cart = [];
function populateProductSelect(){
    const select = document.getElementById('productSelect');
    select.innerHTML = '';
    const items = JSON.parse(localStorage.getItem('pos_inventory') || '[]');
    items.forEach((i, idx)=> select.innerHTML += `<option value="${idx}">${i.name} - ${i.price}</option>`);
}
function addToCart(){
    const idx = parseInt(document.getElementById('productSelect').value);
    const qty = parseInt(document.getElementById('productQty').value);
    const items = JSON.parse(localStorage.getItem('pos_inventory') || '[]');
    if(idx>=0 && qty>0 && items[idx].qty>=qty){
        const item = {...items[idx], qty};
        cart.push(item);
        updateCartTable();
    } else alert('Quantity غلط یا Stock کم ہے');
}
function updateCartTable(){
    const tbody = document.querySelector('#cartTable tbody');
    tbody.innerHTML='';
    let total=0;
    cart.forEach((c,i)=>{
        const row = document.createElement('tr');
        const itemTotal = c.price*c.qty;
        total+=itemTotal;
        row.innerHTML=`<td>${c.name}</td><td>${c.price}</td><td>${c.qty}</td><td>${itemTotal}</td><td><button class="btn red" onclick="removeFromCart(${i})">حذف</button></td>`;
        tbody.appendChild(row);
    });
    document.getElementById('totalAmount').innerText = total;
}
function removeFromCart(i){ cart.splice(i,1); updateCartTable();}
function checkout(){
    if(cart.length===0) return alert('کارٹ خالی ہے');
    const sales = JSON.parse(localStorage.getItem('sales') || '[]');
    const items = JSON.parse(localStorage.getItem('pos_inventory') || '[]');
    cart.forEach(c=>{
        sales.push({...c, date:new Date().toLocaleString()});
        // Reduce stock
        const idx = items.findIndex(i=>i.name===c.name);
        if(idx>=0) items[idx].qty -= c.qty;
    });
    localStorage.setItem('sales', JSON.stringify(sales));
    localStorage.setItem('pos_inventory', JSON.stringify(items));
    cart=[];
    updateCartTable();
    loadInventory();
    alert('سیلز مکمل ہوگئی');
}

// ===== Reports =====
function viewSalesReport(){
    const sales = JSON.parse(localStorage.getItem('sales') || '[]');
    let report = '';
    sales.forEach(s=> report += `${s.date} | ${s.name} | ${s.qty} | ${s.price} | ${s.price*s.qty}\n`);
    document.getElementById('reportOutput').innerText = report || 'کوئی سیلز نہیں';
}
function backupData(){
    const data = {
        teachers: JSON.parse(localStorage.getItem('sch_teachers') || '[]'),
        inventory: JSON.parse(localStorage.getItem('pos_inventory') || '[]'),
        sales: JSON.parse(localStorage.getItem('sales') || '[]')
    };
    const blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href=url; a.download="backup.json"; a.click();
    URL.revokeObjectURL(url);
}
</script>

</body>
</html>
